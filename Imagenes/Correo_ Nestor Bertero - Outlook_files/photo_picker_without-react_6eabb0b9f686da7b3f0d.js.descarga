/*! Version: 5.0.52-r20230103-7.0; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-ba579adca40ded68bad5cef8ccf5fd3175c1b64fc7d6de08d63c90337039613dcb401f85fe7f5d42cc8752f4af4d32984c48ae6be8a1a182572da009da607a87.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[243],{1485:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(2),a=o(0),r=o(74),i=function(t){function e(e){var o=t.call(this,e)||this;return o.state={isRendered:void 0===Object(r.a)()},o}return Object(n.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(a.Component)},1878:function(t,e,o){"use strict";o.d(e,"a",(function(){return l}));var n=o(1287),a=o(0),r=o(3),i=o(31),s=Object(r.declareStringWithPlaceholders)("accessibility-utils-ui.accessibility-utils.positionInSet");function l(t){var e=t.posInSet,o=t.setSize,r=t.onRenderDescribedElement,l=function(t,e){return Object(i.b)(s,{pos:t.toString(),size:e.toString()})}(e,o),c=Object(n.a)();return a.createElement(a.Fragment,null,a.createElement("div",{id:c,hidden:!0},l),r(c))}},2691:function(t,e,o){"use strict";o.r(e),o.d(e,"PhotoPickerStore",(function(){return M})),o.d(e,"StandalonePhotoPicker",(function(){return xe})),o.d(e,"PhotoPicker",(function(){return be})),o.d(e,"initIcons",(function(){return Ee}));var n=o(9),a=o(44),r=o(43),i=o(65),s=o(4);function l(t,e){void 0===e&&(e=null);var o="".concat("PhotoPicker").concat(t,"Action");return Object(s.a)(o,{featureName:"PhotoPicker",exportOptions:e?{exportType:"UserInteraction",exportName:e}:void 0})}var c=l("UploadedPhotoTooSmall"),u=l("CancelButtonClicked","PhotoPickerCancelButtonClicked"),p=l("CloseButtonClicked","PhotoPickerCloseButtonClickedAction"),d=l("DoneButtonClicked","PhotoPickerDoneButtonClickedAction"),m=l("UploadNewPhotoButtonClicked","PhotoPickerUploadNewPhotoButtonClickedAction"),g=l("ImageEditPaneDismissed","PhotoPickerImageEditPaneDismissed"),h=l("ImageUpdated"),f=l("LoadedCurrentImage"),v=l("LoadedEmptyImage"),S=l("LoadedNewImage"),b=l("SomethingWentWrong"),y=l("UploadStarted","PhotoPickerApplyButtonClicked"),E=l("UploadProgress"),I=l("UploadSucceeded"),P=l("WarningDismissed"),C=l("Keyboard"),U=l("ImageRotate"),R=l("Zoom"),x=l("ImageLoaded"),w=l("DragStarted"),k=l("DragProgress"),O=l("ResetEditCanvas"),A=l("EmptyImageRendered"),L=l("SetImageUpdated"),D=l("PhotoListImageSelected"),N=l("NewImageUploaded"),B=l("PhotoListLoadPhotos"),T=function(t,e,o){if(o||2===arguments.length)for(var n,a=0,r=e.length;a<r;a++)!n&&a in e||(n||(n=Array.prototype.slice.call(e,0,a)),n[a]=e[a]);return t.concat(n||Array.prototype.slice.call(e))},j={photoPicker:{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0,isUploadedPhotoTooSmall:!1},editCanvas:{xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,imageRotationAngle:0,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0,imageUpdated:!0},photoList:{selectedIndex:0,imageUrls:[]}},_=Object(i.combineReducers)({photoPicker:Object(a.a)().handleAction(u,z).handleAction(p,z).handleAction(d,z).handleAction(g,z).handleAction(P,(function(t){return Object(n.j)(t,{status:"READY",warning:void 0})})).handleAction(f,(function(t,e){var o=e.payload.dataUrl;return Object(n.j)(t,{dataUrl:t.dataUrl||o,currentImageDataUrl:t.currentImageDataUrl||o,isUpdated:!!e.payload.isSuggestedPhoto||!!e.payload.isPhotoListPresent})})).handleAction(S,(function(t,e){return Object(n.j)(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:e.payload.fileName})})).handleAction(v,(function(t,e){return Object(n.j)(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl||!!e.payload.isPhotoListPresent,fileName:void 0})})).handleAction(y,(function(t,e){return Object(n.j)(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})})).handleAction(E,(function(t,e){return"IN_PROGRESS"===t.status?Object(n.j)(t,{uploadDuration:e.payload.now-t.uploadStart}):t})).handleAction(I,(function(t,e){return Object(n.j)(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})})).handleAction(b,(function(t,e){return Object(n.j)(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})})).handleAction(h,(function(t){return Object(n.j)(t,{isUpdated:!0})})).handleAction(c,(function(t,e){return Object(n.j)(t,e.payload)})).done(j.photoPicker),editCanvas:Object(a.a)().handleAction(O,W).handleAction(C,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(R,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(x,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(w,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(k,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(L,(function(t){return Object(n.j)(t,{imageUpdated:!0})})).handleAction(A,(function(t){return Object(n.j)(t,{initialRender:!1})})).handleAction(u,W).handleAction(p,W).handleAction(d,W).handleAction(g,W).handleAction(U,(function(t,e){return Object(n.j)(t,e.payload)})).done(j.editCanvas),photoList:Object(a.a)().handleAction(D,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(N,(function(t,e){return Object(n.j)(t,{selectedIndex:e.payload.selectedIndex,imageUrls:T([e.payload.newImageUrl],t.imageUrls,!0)})})).handleAction(B,(function(t,e){return Object(n.j)(t,e.payload)})).handleAction(u,F).handleAction(p,F).handleAction(d,F).handleAction(g,F).done(j.photoList)}),M=Object(r.a)("PhotoPickerStore",_,(function(t){return{getPhotoPickerState:function(){return t.photoPicker},getEditCanvasState:function(){return t.editCanvas},getPhotoListState:function(){return t.photoList}}}));function z(t){return Object(n.j)(t,{dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,isUpdated:!1,fileName:void 0})}function W(t){return Object(n.j)(t,j.editCanvas)}function F(t){return Object(n.j)(t,j.photoList)}var H=o(5),G=o.n(H),Y=o(693),K=o.n(Y),X=o(480),Z=o.n(X),V=o(925),q=o(481),J=o(1149),Q=o(0),$=o(56),tt=o.n($),et=o(80),ot=o.n(et),nt=o(131);function at(t,e){try{return e?t.toDataURL():t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}var rt={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]};function it(t,e,o,n,a,r){t.save(),t.translate(e/2,e/2),t.transform.apply(t,rt[n]),t.rotate(o),t.translate(-e/2,-e/2),r(t,a),t.restore()}function st(t,e,o,n){var a=rt[o],r=a[0],i=a[2];return{x:(e=(t=(t-=128)*r+(e-=128)*a[1])*i+e*a[3])*Math.sin(n)+t*Math.cos(n)+128,y:e*Math.cos(n)-t*Math.sin(n)+128}}function lt(t,e,o){return Math.min(o,Math.max(t,e))}var ct=o(114),ut=o(962),pt=o(2117),dt=o(837),mt=o(2392),gt=o(1873),ht=o(1175),ft=o(13),vt=o(115),St=Object(vt.c)((function(t){var e=t.palette;return Object(ft.cb)({picker:t.fonts.medium,uploadHeader:t.fonts.xLarge,messageBarText:t.fonts.medium},{modal:{width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button--icon &hover":{color:e.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:e.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:e.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:e.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:e.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:e.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:e.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:e.neutralTertiaryAlt}}},picker:{padding:32,overflow:"hidden"},header:{display:"flex",alignContent:"space-between"},uploadHeader:{color:e.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},messageBar:{margin:"7px 0",color:e.neutralPrimary},fileInput:{display:"none"},fileInputButton:{color:e.themePrimary,padding:0,margin:"0 0 12px -4px"},closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"},endActions:{marginTop:t.spacing.l1,alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:62,padding:"0px 4px",fontSize:t.fonts.medium.fontSize,borderRadius:4}}},editCanvasAndPhotoListContainer:{display:"flex",padding:"0px 8px"}})})),bt=function(t){var e=t.onClick,o=t.dataLogName,n=t.ariaLabel,a=t.title,r=St(Object(ut.a)());switch(t.buttonType){case"Primary":return Q.createElement(pt.a,{disabled:t.disabled,onClick:e,"data-log-name":o,ariaLabel:n,title:a,componentRef:t.buttonRef},t.buttonLabel);case"Action":return Q.createElement(dt.a,{className:r.removeButton,iconProps:{iconName:t.iconName},onClick:e,"data-log-name":o,disabled:t.disabled,title:a},t.buttonLabel);case"Icon":return Q.createElement(ht.a,{content:a,styles:{root:r.closeButton}},Q.createElement(mt.a,{iconProps:{iconName:t.iconName},onClick:e,"data-log-name":o,ariaLabel:n}));case"Default":return Q.createElement(gt.a,{onClick:e,"data-log-name":o,ariaLabel:n,title:a},t.buttonLabel);default:return t}},yt=o(1918),Et=o(2736),It=function(t){var e=St(Object(ut.a)()),o="UNKNOWN"===t.warning,n="IMAGE_TOO_SMALL_ERROR"===t.warning,a=o||n?yt.a.error:yt.a.warning,r=o?void 0:t.onDismiss;return Q.createElement(Et.a,{className:e.messageBar,messageBarType:a,onDismiss:r,isMultiline:!0,"aria-live":"polite",dismissButtonAriaLabel:t.dismissButtonAriaLabel},Q.createElement("div",{className:e.messageBarText},t.warningText))},Pt=o(2732),Ct=o(2523),Ut=function(t){var e=t.hideTitleText,o=t.isComponentInline,n=t.titleText,a=t.closeIcon,r=t.infoBar,i=t.uploadPhoto,s=t.editCanvas,l=t.applyButton,c=t.cancelButton,u=t.removeButton,p=t.onDismiss,d=t.focusTrapRef,m=t.hideEndActions,g=t.imageEditorDescription,h=t.customUploadButton,f=t.photoList,v=St(Object(ut.a)()),S=Q.createElement(Q.Fragment,null,!o&&a,!e&&Q.createElement("div",{className:v.header,id:"dialogTitle",role:"heading","aria-level":1},Q.createElement("div",{className:v.uploadHeader},n)),r,i,Q.createElement("div",{className:v.editCanvasAndPhotoListContainer},s,f),g,!m&&Q.createElement("div",{className:v.endActions},l,c,u),h);return Q.createElement(Q.Fragment,null,o?Q.createElement("div",{id:"lpc-photo-picker",className:v.picker},S):Q.createElement(Ct.a,{className:"lpc_nested_popup",containerClassName:v.modal,isOpen:!0,onDismiss:p,titleAriaId:"dialogTitle"},Q.createElement(Pt.a,{id:"lpc-photo-picker",className:v.picker,componentRef:d,firstFocusableSelector:"photoPickerFirstFocusableSelector"},S)))},Rt=function(t){var e=St(Object(ut.a)()),o=null;return Q.createElement(Q.Fragment,null,Q.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:function(t){return o=t},onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.onFileSelected(e.currentTarget.files[0],t.isPhotoListPresent)},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),Q.createElement(dt.a,{componentRef:t.buttonRef,className:"".concat(e.fileInputButton," ").concat("photoPickerFirstFocusableSelector"),iconProps:{iconName:"Add"},onClick:function(){o&&o.click(),t.onUploadNewPhoto()}},t.uploadText))},xt=o(328),wt=o(533),kt=o(58),Ot=o(1159),At=o(202);function Lt(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),o=atob(e),n=o.length,a=new ArrayBuffer(n),r=new Uint8Array(a),i=0;i<n;i++)r[i]=o.charCodeAt(i);return a}(t));if(65496!==e.getUint16(0,!1))return 1;for(var o,n=e.byteLength,a=2;a<n;){var r=e.getUint16(a,!1);if(a+=2,65505===r){if(1165519206!==e.getUint32(a+=2,!1))break;var i=18761===e.getUint16(a+=6,!1);a+=e.getUint32(a+4,i);var s=e.getUint16(a,i);a+=2;for(var l=0;l<s;l++)if(274===e.getUint16(a+12*l,i))return(o=e.getUint16(a+12*l+8,i))<1||o>8?1:o}else{if(65280!=(65280&r))break;a+=e.getUint16(a,!1)}}return 1}var Dt=o(1300),Nt=o(2753),Bt=function(){return(Bt=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Tt=Object(vt.c)((function(t,e,o){var n=t.palette;return Object(ft.cb)({editControls:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",height:32},editControlsPlaceholderSpace:{height:32},zoomButton:{selectors:{"&:disabled":{background:n.white}}},editCanvas:{backgroundColor:n.white,cursor:e?"move":"inherit"},isDropActive:{outline:"1px solid purple"},invisible:Bt({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),slider:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{".ms-Slider-thumb":{border:"2px solid ".concat(n.themePrimary)},".ms-Slider-active":{backgroundColor:n.themePrimary},".ms-Slider-inactive":{backgroundColor:n.themeLight}}},canvasContainer:{margin:o?"0 0 0 auto":"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:{color:n.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},initials:{fontSize:128,lineHeight:128},zoomAnnouncement:{position:"absolute",width:1,height:1,margin:-1,overflowX:"hidden",overflowY:"hidden"}})})),jt=function(t){var e=Object(ut.a)(),o=Tt(e,t.panEnabled),n=Q.useCallback((function(e){var o=e-t.imageRotationAngle+t.baseAngleForStraightening;t.onImageRotate(o)}),[t.onImageRotate,t.imageRotationAngle,t.baseAngleForStraightening]),a=Q.useCallback((function(){t.onImageRotate(Math.PI/2),t.setBaseAngleForStraightening(t.baseAngleForStraightening+Math.PI/2)}),[t.onImageRotate,t.baseAngleForStraightening]),r=Q.useCallback((function(){t.onImageRotate(-Math.PI/2),t.setBaseAngleForStraightening(t.baseAngleForStraightening-Math.PI/2)}),[t.onImageRotate,t.baseAngleForStraightening]);return Q.createElement("div",{className:o.editControls},Q.createElement(mt.a,{className:o.zoomButton,title:t.counterClockwiseString,ariaLabel:t.counterClockwiseString,onClick:r,onRenderIcon:_t}),Q.createElement(ht.a,{content:t.rotateString,styles:{root:o.slider}},Q.createElement(Nt.a,{min:-Math.PI/4,max:Math.PI/4,step:Math.PI/180,value:t.imageRotationAngle-t.baseAngleForStraightening,showValue:!1,originFromZero:!0,onChange:n})),Q.createElement(mt.a,{className:o.zoomButton,title:t.clockwiseString,ariaLabel:t.clockwiseString,onClick:a,onRenderIcon:Mt}))};function _t(){return Q.createElement("span",null,Q.createElement(Dt.e,null))}function Mt(){return Q.createElement("span",null,Q.createElement(Dt.f,null))}var zt,Wt=o(2740),Ft=o(2138),Ht=o(2554),Gt=Object(vt.c)((function(t){var e=t.palette;return Object(ft.cb)({editPivot:{height:46},pivotLink:{lineHeight:10,width:46,height:46,padding:0,marginRight:0,color:e.neutralTertiary},pivotLinkSelected:{color:e.neutralDark},pivotButton:{flex:"0 1 100%",height:44},pivotButtonText:{fontSize:10,marginTop:5}})})),Yt=function(t){var e=Object(ut.a)(),o=Gt(e),n=t.maximumScale<=1;function a(e){if(!(null==e?void 0:e.itemKey))return null;var n=e.itemKey;return Q.createElement("span",{className:o.pivotButton},"Rotate"===n?Q.createElement(Dt.d,null):Q.createElement(Ht.a,null),Q.createElement("div",{className:o.pivotButtonText},"Rotate"===n?t.rotateString:t.zoomString))}return Q.createElement(Wt.a,{styles:{root:o.editPivot,link:o.pivotLink,linkIsSelected:o.pivotLinkSelected},"aria-label":t.pivotString,selectedKey:t.selectedKey,onLinkClick:function(e){var o;(null===(o=null==e?void 0:e.props)||void 0===o?void 0:o.itemKey)&&t.setSelectedKey(e.props.itemKey)},headersOnly:!0},Q.createElement(Ft.a,{itemKey:"Zoom",headerButtonProps:{disabled:n,title:n?t.zoomAtMaxString:void 0},onRenderItemLink:a}),Q.createElement(Ft.a,{itemKey:"Rotate",onRenderItemLink:a}))},Kt=function(t){var e=Q.useState(!1),o=e[0],n=e[1],a=Q.useState(),r=a[0],i=a[1],s=Q.useCallback((function(e,o){!t.image||t.maximumScale<1||t.zoom(f(e)-t.relativeScale,.5*o,.5*o,!1)}),[t.image,t.maximumScale,t.zoom]),l=Q.useCallback((function(e,a){t.zoom(e,a/2,a/2,!0),o&&clearTimeout(r),n(!0),i(window.setTimeout((function(){return n(!1)}),3e3))}),[t.zoom,o,r]),c=Object(ut.a)(),u=t.maximumScale,p=Tt(c,t.panEnabled),d=lt(2*t.stepSize,.1,.2),m=t.canvasSize,g=function(t){return"".concat(t,"%")},h=function(t){return Math.round(100*(t*(u-1)+1))},f=function(t){return Math.round((t/100-1)/(u-1)*100)/100};return Q.createElement("div",{className:p.editControls},Q.createElement(mt.a,{className:p.zoomButton,iconProps:{iconName:"CalculatorSubtract"},title:t.zoomOutString,ariaLabel:t.zoomOutString,onClick:function(){l(-d,m)},disabled:t.zoomOutDisabled}),Q.createElement(ht.a,{content:t.zoomString,styles:{root:p.slider}},Q.createElement(Nt.a,{ariaValueText:g,ariaLabel:t.zoomString,min:h(0),max:h(1),step:h(lt(t.stepSize,.05,.1))-h(0),value:h(t.relativeScale),showValue:!1,onChange:function(t){return s(t,m)}})),Q.createElement(mt.a,{className:p.zoomButton,iconProps:{iconName:"CalculatorAddition"},title:t.zoomInString,ariaLabel:t.zoomInString,onClick:function(){l(d,m)},disabled:t.zoomInDisabled}),o&&Q.createElement("div",{"aria-live":"assertive",role:"status",className:p.zoomAnnouncement},g(h(t.relativeScale))))},Xt=function(t){var e=!1,o=Q.useRef(null),n=null,a=Object(Ot.a)(t.personDisplayName,Object(At.a)()),r=!t.image||t.maximumScale<=1||t.progress>0,i=t.image,s=!r||t.naturalHeight!==t.naturalWidth,l=Object(ut.a)(),c=Tt(l,s,t.isPhotoListPresent),u=Q.useState(),p=u[0],d=u[1],m=Q.useState(0),g=m[0],h=m[1],f=Q.useState(),v=f[0],S=f[1],b=Q.useCallback((function(e,o,n,a){if(void 0===a&&(a=!0),t.image&&!(t.maximumScale<1)){var r=Math.min(1,Math.max(0,t.relativeScale+e));if(r!==t.relativeScale){var i=Math.exp(r*Math.log(t.maximumScale)),s=i<=1,l=i>=t.maximumScale,c=I(o,t.xpos,t.naturalWidth,i),u=I(n,t.ypos,t.naturalHeight,i);a&&(s||l)&&t.onRefocus(),t.onZoomEvent({absoluteScale:i,relativeScale:r,zoomOutDisabled:s,zoomInDisabled:l,xpos:c,ypos:u}),t.onUpdate()}}}),[t.image,t.maximumScale,t.relativeScale,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.onRefocus,t.onZoomEvent,t.onUpdate]),y=Q.useCallback((function(e){var o=t.imageRotationAngle+e;t.onRotateEvent({imageRotationAngle:o}),t.onUpdate()}),[t.imageRotationAngle,t.onRotateEvent,t.onUpdate]),E=Q.useCallback((function(e){switch(e.key){case"+":return b(t.stepSize,128,128,!1);case"-":return b(-1*t.stepSize,128,128,!1)}var o=st((e.which===kt.a.left?1:e.which===kt.a.right&&-1)||0,(e.which===kt.a.up?1:e.which===kt.a.down&&-1)||0,t.orientation,t.imageRotationAngle),n=o.x,a=o.y;if(t.image){var r=n*t.naturalWidth/100,i=a*t.naturalHeight/100,s=L(t.xpos+r,t.naturalWidth*t.absoluteScale/t.maximumScale),l=L(t.ypos+i,t.naturalHeight*t.absoluteScale/t.maximumScale);t.onKeybordEvent({xpos:s,ypos:l})}}),[t.stepSize,t.orientation,t.image,t.naturalWidth,t.naturalHeight,t.xpos,t.ypos,t.absoluteScale,t.maximumScale,t.onKeybordEvent,t.imageRotationAngle,b]),I=Q.useCallback((function(e,o,n,a){var r=e+(o-e)*a/t.absoluteScale,i=a*n/t.maximumScale;return L(r,i)}),[t.absoluteScale,t.maximumScale]),P=Q.useCallback((function(n){var a,r,i,s=1;"Fit"===t.imageScaling?(s=1.2,r=Math.max(n.naturalWidth,n.naturalHeight),i=r*s/256):(r=Math.min(n.naturalWidth,n.naturalHeight),i=r/256);var l=function(t){return-.5*(t/i-256)},c=Math.min(1,Math.max(.01,256/(2*Math.max(n.naturalWidth,n.naturalHeight))));h(0),!t.initialRender&&i<1&&(n.naturalHeight<48||n.naturalWidth<48?setTimeout((function(){return t.onError("IMAGE_TOO_SMALL_ERROR")}),0):setTimeout((function(){return t.onError("IMAGE_TOO_SMALL_WARNING")}),0)),t.isUploadedPhotoTooSmall(n.naturalHeight<48||n.naturalWidth<48),e||t.onImageLoaded({naturalMin:r,naturalWidth:n.naturalWidth*s,naturalHeight:n.naturalHeight*s,stepSize:c,maximumScale:i,orientation:Lt(n.src),imageRotationAngle:0,image:n,zoomInDisabled:!1,initialRender:!1,xpos:l(n.naturalWidth*s),ypos:l(n.naturalHeight*s),absoluteScale:1,relativeScale:0,imageUpdated:!1}),!t.initialRender&&(null===(a=o.current)||void 0===a||a.focus())}),[t.initialRender,t.onError,t.isUploadedPhotoTooSmall,t.onImageLoaded,e,o]),C=Q.useCallback((function(e){if(e){var o=new Image;o.onload=function(){return P(o)},o.src=e}else t.onReset(),""===e&&t.onEmptyImageRendered()}),[t.onReset,P]),U=Q.useCallback((function(e){if(t.image){Zt(e);var o=e.deltaY>0?-1:1,n=st(e.nativeEvent.offsetX,e.nativeEvent.offsetY,t.orientation,t.imageRotationAngle),a=n.x,r=n.y;b(lt(t.stepSize,.05,.1)*o,a,r)}}),[t.image,t.orientation,t.stepSize,b,t.imageRotationAngle]),R=Q.useCallback((function(e){var o=Vt(e),n=st(o[0],o[1],t.orientation,t.imageRotationAngle),a=n.x,r=n.y;t.image&&(Zt(e),t.onDragStart({moving:!0,lastMouseX:a,lastMouseY:r}))}),[t.image,t.onDragStart,t.orientation,t.imageRotationAngle]),x=Q.useCallback((function(e){Zt(e);var o="mousemove"===e.type||"touchmove"===e.type,n=Vt(e),a=st(n[0],n[1],t.orientation,t.imageRotationAngle),r=a.x,i=a.y;if(t.image&&t.moving){var s=L(t.xpos+(r-t.lastMouseX),t.naturalWidth*t.absoluteScale/t.maximumScale),l=L(t.ypos+(i-t.lastMouseY),t.naturalHeight*t.absoluteScale/t.maximumScale);(t.xpos!==s||t.ypos!==l)&&t.onUpdate(),t.onDragProgress({moving:o,xpos:s,ypos:l,lastMouseX:r,lastMouseY:i})}}),[t.orientation,t.image,t.moving,t.xpos,t.ypos,t.lastMouseX,t.lastMouseY,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.onUpdate,t.onDragProgress,t.imageRotationAngle]),w=Q.useCallback((function(t){Zt(t),d(!0)}),[d]),k=Q.useCallback((function(t){Zt(t),d(!1)}),[d]),O=Q.useCallback((function(e){k(e),e.dataTransfer&&t.onFileSelected(e.dataTransfer.files[0],t.isPhotoListPresent)}),[t.onFileSelected]),A=Q.useCallback((function(){var e,a=o.current;if(a&&n){var r=a.getContext("2d");if(r){var i=window.getComputedStyle(a);r.fillStyle=i.backgroundColor||"#ffffff",r.fillRect(0,0,1,1);var s=r.getImageData(0,0,1,1).data,l="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.6)"),c="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1)"),u=Object(wt.a)({text:t.personDisplayName});""===t.dataUrl?(r.fillStyle=u,n.style.display="flex"):(r.fillStyle=t.customBackgroundColor||"white",n.style.display="none"),r.fillRect(0,0,256,256),t.image&&it(r,256,t.imageRotationAngle,t.orientation,t.image,(function(e,o){return e.drawImage(o,t.xpos,t.ypos,t.naturalWidth*t.absoluteScale/t.maximumScale,t.naturalHeight*t.absoluteScale/t.maximumScale)})),null===(e=t.onCanvasUpdated)||void 0===e||e.call(t,a),"Circle"===t.imageCropShape&&(r.save(),r.beginPath(),r.rect(0,0,256,256),r.arc(128,128,125,0,2*Math.PI,!0),r.clip(),r.fillStyle=l,r.fillRect(0,0,256,256),r.restore(),r.save(),r.beginPath(),r.arc(128,128,126,0,2*Math.PI,!0),r.lineWidth=2,r.strokeStyle=c,r.stroke(),r.restore(),r.save(),r.beginPath(),r.lineWidth=4,r.fillStyle="rgba(0, 120, 215, 0.5)",r.strokeStyle="rgba(0, 120, 215, 0.5)",r.arc(128,128,125,-Math.PI/2,2*t.progress*Math.PI-Math.PI/2,!1),1===t.progress&&r.fill(),r.stroke(),r.restore())}else t.onError("UNSUPPORTED_BROWSER")}}),[t.personDisplayName,t.dataUrl,t.image,t.imageRotationAngle,t.orientation,t.xpos,t.ypos,t.naturalWidth,t.naturalHeight,t.absoluteScale,t.maximumScale,t.progress,t.onError,t.customBackgroundColor,t.onCanvasUpdated,t.imageCropShape]),L=Q.useCallback((function(e,o){return"Fit"===t.imageScaling&&o<256?(256-o)/2:e>0?0:e+o<256?256-o:e}),[t.imageScaling]);Q.useEffect((function(){return A(),function(){e=!0}}),[]),Q.useEffect((function(){A()})),Q.useEffect((function(){1===t.progress&&t.onRefocus()}),[t.progress]),Q.useEffect((function(){t.dataUrl?(t.imageUpdated&&C(t.dataUrl),S(r?"Rotate":"Zoom")):(t.onReset(),""===t.dataUrl&&t.onEmptyImageRendered())}),[t.dataUrl,t.imageUpdated,r]);var D=Q.useMemo((function(){var e,o;return t.image?1===t.progress?t.strings.success:t.fileName?null===(o=(e=t.strings).photoSelected)||void 0===o?void 0:o.call(e,{p0:t.fileName}):t.strings.dropZoneImageAriaLabel:t.strings.dropZoneEmptyAriaLabel}),[t.image,t.fileName,t.progress]);return Q.createElement("div",{className:c.canvasContainer},Q.createElement("canvas",{className:"".concat(c.editCanvas," ").concat(p?c.isDropActive:""),role:"img",tabIndex:0,ref:o,width:256,height:256,onKeyDown:function(t){return E(t)},"aria-label":D,onDragEnter:w,onDrop:O,onDragLeave:k,onDragOver:Zt,onMouseDown:R,onMouseMove:x,onMouseUp:x,onMouseLeave:x,onWheel:U,onTouchStart:R,onTouchMove:x,onTouchEnd:x}),Q.createElement("div",{className:c.textboy,ref:function(t){return n=t},onDragEnter:w,onDragLeave:k,onDragOver:Zt,onDrop:O},Q.createElement("div",{className:c.initials},a),Q.createElement("div",null,t.strings.dropZone)),Q.createElement("div",{role:"region","aria-live":"assertive","aria-atomic":!0},1===t.progress?Q.createElement("div",{className:c.textboy},Q.createElement("span",{className:c.invisible},t.strings.success),Q.createElement(xt.a,{className:c.initials,iconName:"CheckMark"})):null),i?Q.createElement(Q.Fragment,null,"Zoom"!==v&&t.enableImageRotation?Q.createElement(jt,{clockwiseString:t.strings.clockwise,counterClockwiseString:t.strings.counterClockwise,rotateString:t.strings.rotate,baseAngleForStraightening:g,setBaseAngleForStraightening:h,onImageRotate:y,imageRotationAngle:t.imageRotationAngle,panEnabled:s}):Q.createElement(Kt,{zoomOutString:t.strings.zoomOut,zoomInString:t.strings.zoomIn,zoomString:t.strings.zoom,canvasSize:256,image:t.image,maximumScale:t.maximumScale,stepSize:t.stepSize,zoomOutDisabled:t.zoomOutDisabled,relativeScale:t.relativeScale,zoomInDisabled:t.zoomInDisabled,panEnabled:s,zoom:b}),t.enableImageRotation&&Q.createElement(Yt,{zoomAtMaxString:t.strings.zoomAtMax,maximumScale:t.maximumScale,selectedKey:v,setSelectedKey:S,rotateString:t.strings.rotate,zoomString:t.strings.zoom,pivotString:t.strings.pivot})):Q.createElement("div",{className:c.editControlsPlaceholderSpace}))},Zt=function(t){t.stopPropagation(),t.preventDefault()},Vt=function(t){return"targetTouches"in t?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:[t.clientX,t.clientY]},qt=(zt=function(t,e){return(zt=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}zt(t,e),t.prototype=null===e?K()(e):(o.prototype=e.prototype,new o)}),Jt=function(){return(Jt=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Qt=function(t){function e(e){return t.call(this,e)||this}return qt(e,t),e.prototype.render=function(){return Q.createElement(Xt,Jt({},this.props))},e}(Q.Component);var $t=Object(nt.c)((function(t){return M.getSelectors(t).getEditCanvasState()}),(function(t){return{onReset:function(){return t(O())},onKeybordEvent:function(e){return t(C({xpos:e.xpos,ypos:e.ypos}))},onZoomEvent:function(e){return t(R({absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,zoomOutDisabled:e.zoomOutDisabled,zoomInDisabled:e.zoomInDisabled,xpos:e.xpos,ypos:e.ypos}))},onImageLoaded:function(e){return t(x({naturalMin:e.naturalMin,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,stepSize:e.stepSize,maximumScale:e.maximumScale,orientation:e.orientation,imageRotationAngle:e.imageRotationAngle,image:e.image,zoomInDisabled:e.zoomInDisabled,initialRender:e.initialRender,xpos:e.xpos,ypos:e.ypos,absoluteScale:e.absoluteScale,relativeScale:e.relativeScale,imageUpdated:e.imageUpdated}))},onDragStart:function(e){return t(w({moving:e.moving,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onDragProgress:function(e){return t(k({moving:e.moving,xpos:e.xpos,ypos:e.ypos,lastMouseX:e.lastMouseX,lastMouseY:e.lastMouseY}))},onEmptyImageRendered:function(){return t(A())},onRotateEvent:function(e){return t(U({imageRotationAngle:e.imageRotationAngle}))}}}))(Qt),te=o(1878),ee=o(596),oe=o(350),ne=o(60),ae=o(614),re=function(t){var e,o,n,a=Object(ut.a)(),r=(e=t.isLastPhoto,o=t.index===t.selectedIndex,n=t.isEmptyPhoto,Object(ae.a)((function(t){var a=t.palette;return{photoListItem:{height:56,width:56,marginBottom:e?0:10,border:o?"2px solid ".concat(a.themePrimary):"none",boxSizing:"border-box",display:"flex",padding:0,background:n?a.neutralLighter:"transparent",cursor:"pointer"},photoListItemImage:{height:"100%",width:"100%"},emptyPhotoIcon:{margin:"auto",fontSize:"24px",color:a.neutralSecondaryAlt}}})))(a);return Q.createElement("button",{className:r.photoListItem,onClick:function(){var e;t.onClickHandler({selectedIndex:t.index,imageUrl:t.imageUrl||"",fileName:"".concat(t.photoListImageAriaLabel," ").concat(t.index+1)}),t.isEmptyPhoto&&(null===(e=t.onPhotoRemoved)||void 0===e||e.call(t))},"aria-describedby":t.ariaDescribedBy},t.isEmptyPhoto?Q.createElement(ee.a,{"aria-label":t.photoListEmptyImageAriaLabel,iconName:"Contact",className:r.emptyPhotoIcon}):Q.createElement(oe.a,{src:t.imageUrl,className:r.photoListItemImage,alt:t.photoListImageAriaLabel,imageFit:ne.b.cover}))},ie=Object(ae.b)({photoList:{height:256,width:56,padding:"0px 25px 0px 12px",overflowY:"auto",margin:0,listStyle:"none"}}),se=function(t){var e=ie(),o=t.imageUrls,n=t.showEmptyPhoto?o.length:o.length-1;return Q.createElement("ul",{className:e.photoList,"aria-label":t.strings.photoListAriaLabel},o.map((function(e,o){return Q.createElement(te.a,{posInSet:o+1,setSize:n+1,key:o,onRenderDescribedElement:function(a){return Q.createElement("li",{key:o},Q.createElement(re,{key:o,imageUrl:e,index:o,selectedIndex:t.selectedIndex,isLastPhoto:o===n,photoListImageAriaLabel:t.strings.photoListImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,ariaDescribedBy:a}))}})})),!!t.showEmptyPhoto&&Q.createElement(te.a,{posInSet:n+1,setSize:n+1,onRenderDescribedElement:function(e){return Q.createElement("li",null,Q.createElement(re,{key:o.length,index:o.length,selectedIndex:t.selectedIndex,isLastPhoto:!0,isEmptyPhoto:!0,photoListEmptyImageAriaLabel:t.strings.photoListEmptyImageAriaLabel,onClickHandler:t.onPhotoListImageSelected,onPhotoRemoved:t.onPhotoRemoved,ariaDescribedBy:e}))}}))},le=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?K()(o):(n.prototype=o.prototype,new n)}}(),ce=function(){return(ce=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},ue=function(t){function e(e){return t.call(this,e)||this}return le(e,t),e.prototype.componentDidMount=function(){this.props.photoListLoadPhotos(this.props.photoListSelectedIndex||0,this.props.photoListImageUrls)},e.prototype.render=function(){return Q.createElement(se,ce({},this.props))},e}(Q.Component);var pe=Object(nt.c)((function(t){return M.getSelectors(t).getPhotoListState()}),(function(t){return{photoListLoadPhotos:function(e,o){t(B({selectedIndex:e,imageUrls:o}))},onPhotoListImageSelected:function(e){!function(t,e,o,n){if(!e)return t(v({isPhotoListPresent:!0})),void t(D({selectedIndex:o}));if(e.startsWith("data:image/"))return t(S({dataUrl:e,isPhotoListPresent:!0,fileName:n})),t(L()),void t(D({selectedIndex:o}));var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var e=document.createElement("canvas");e.width=a.naturalWidth,e.height=a.naturalHeight;var r=e.getContext("2d");r&&(r.drawImage(a,0,0),t(S({dataUrl:at(e,!1),isPhotoListPresent:!0,fileName:n})),t(L()),t(D({selectedIndex:o})))},a.src=e}(t,e.imageUrl,e.selectedIndex,e.fileName)}}}))(ue),de=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?K()(o):(n.prototype=o.prototype,new n)}}(),me=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var o=.5/e(1);return function(t){return t<=0?0:t>1?1:o*e(2*t-1)+.5}}(5),ge=function(t){function e(e){var o=t.call(this,e)||this;return o.focusTrap=null,o.primaryButton=null,o.uploadFileButton=null,o.handleOnRemoveButtonClicked=function(){o.props.loadedEmptyImage(ot()(o.props.personImageUrl)),o.uploadFileButton&&o.uploadFileButton.focus()},o.handleOnSaveButtonClicked=function(){switch(o.props.status){case"SUCCESS":return o.props.onDone(),o.props.onDismiss();default:o.props.startUpload()}},o.handleUploadAnimation=function(){"IN_PROGRESS"===o.props.status&&o.props.onUploadProgress(tt()())},o.handleOnCancelButtonClicked=function(){o.props.onCancel(),o.props.onDismiss()},o.handleOnCloseButtonClicked=function(){o.props.onClose(),o.props.onDismiss()},o.getFocusTrapRef=o.getFocusTrapRef.bind(o),o.getButtonRef=o.getButtonRef.bind(o),o.getUploadButtonRef=o.getUploadButtonRef.bind(o),o}return de(e,t),e.prototype.getFocusTrapRef=function(){var t=this,e=function(e){return t.focusTrap=e};return e.current=null,e},e.prototype.getButtonRef=function(){var t=this,e=function(e){return t.primaryButton=e};return e.current=null,e},e.prototype.getUploadButtonRef=function(){var t=this,e=function(e){return t.uploadFileButton=e};return e.current=null,e},e.prototype.render=function(){var t,e,o=this,n=this.getWarningText(this.props.warning);return Q.createElement(Ut,{onDismiss:this.props.onDismiss,focusTrapRef:this.getFocusTrapRef(),hideTitleText:!!this.props.hideUploadHeader,isComponentInline:!!this.props.isComponentInline,titleText:this.props.strings.uploadHeader,imageEditorDescription:this.props.strings.imageEditorDescription,hideEndActions:this.props.hideButtons,closeIcon:Q.createElement(bt,{buttonType:"Icon",iconName:"Cancel",onClick:this.handleOnCloseButtonClicked,dataLogName:"PhotoPickerClose",title:this.props.strings.closeIconTitle,ariaLabel:this.props.strings.closeIconAriaLabel}),infoBar:n?Q.createElement(It,{warning:this.props.warning,warningText:n,onDismiss:this.props.onDismissInfoBar,dismissButtonAriaLabel:this.props.strings.infoBarDismissButtonAriaLabel}):null,uploadPhoto:this.props.hideUploadPhotoButton&&this.props.renderCustomUploadButton?null:Q.createElement(Rt,{buttonRef:this.getUploadButtonRef(),onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto,uploadText:this.props.strings.upload,isPhotoListPresent:ot()(this.props.personImageUrl)}),editCanvas:Q.createElement($t,{dataUrl:this.props.dataUrl,enableImageRotation:this.props.enableImageRotation,fileName:this.props.fileName,personDisplayName:this.props.personDisplayName,progress:this.props.progress,warning:n,strings:this.props.strings,onError:this.props.onError,isUploadedPhotoTooSmall:function(t){return o.props.onUploadedPhotoTooSmall(t)},onFileSelected:this.props.onFileSelected,onRefocus:function(){return o.onFocusChange()},onUpdate:this.props.onImageUpdated,imageCropShape:this.props.imageCropShape||"Circle",imageScaling:this.props.imageScaling||"Fill",onCanvasUpdated:this.props.onCanvasUpdated,isComponentInline:!!this.props.isComponentInline,customBackgroundColor:this.props.customBackgroundColor,isPhotoListPresent:ot()(this.props.personImageUrl)}),photoList:ot()(this.props.personImageUrl)?Q.createElement(pe,{photoListImageUrls:this.props.personImageUrl,photoListSelectedIndex:this.props.photoListSelectedIndex,showEmptyPhoto:!!this.props.showPhotoListEmptyPhoto,strings:this.props.strings,onPhotoRemoved:function(){var t;null===(t=o.uploadFileButton)||void 0===t||t.focus()}}):null,applyButton:Q.createElement(bt,{buttonType:"Primary",buttonLabel:this.getSaveButtonText(this.props.status),dataLogName:"PhotoPickerOkay",onClick:this.handleOnSaveButtonClicked,disabled:this.getIsPrimaryButtonDisabled(),buttonRef:this.getButtonRef()}),cancelButton:this.props.progress>0?null:Q.createElement(bt,{buttonType:"Default",buttonLabel:this.props.strings.cancel,dataLogName:"PhotoPickerCancel",onClick:this.handleOnCancelButtonClicked}),removeButton:this.props.isImageRemovable?Q.createElement(bt,{buttonType:"Action",buttonLabel:this.props.strings.remove,iconName:"Delete",dataLogName:"PhotoPickerDelete",disabled:this.getIsRemoveButtonDisabled(),onClick:this.handleOnRemoveButtonClicked}):null,customUploadButton:null===(e=(t=this.props).renderCustomUploadButton)||void 0===e?void 0:e.call(t,{onFileSelected:this.props.onFileSelected,onUploadNewPhoto:this.props.onUploadNewPhoto})})},e.prototype.componentDidMount=function(){var t=this;this.props.loadCurrentImage(),requestAnimationFrame((function(){return t.focusTrap&&t.focusTrap.focus()}))},e.prototype.componentWillUnmount=function(){this.props.onImageEditPaneDismissed()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.onFocusChange=function(){"SUCCESS"===this.props.status?this.primaryButton&&this.primaryButton.focus():this.focusTrap&&this.focusTrap.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return Object(ct.a)(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL_WARNING":return this.props.strings.imageTooSmall;case"IMAGE_TOO_SMALL_ERROR":return this.props.strings.imageTooSmallError;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.getIsPrimaryButtonDisabled=function(){return!this.props.isUpdated||"IN_PROGRESS"===this.props.status||this.props.isUploadedPhotoTooSmall},e.prototype.getIsRemoveButtonDisabled=function(){return!this.props.dataUrl||"IN_PROGRESS"===this.props.status},e}(Q.Component);var he=Object(nt.c)((function(t){var e=M.getSelectors(t).getPhotoPickerState(),o=0;switch(e.status){case"IN_PROGRESS":var n=e.uploadDuration/2e3;o=.999999*me(n);break;case"SUCCESS":o=1;break;case"READY":case"SOMETHING_WENT_WRONG":o=0;break;default:Object(ct.a)(e.status)}return{dataUrl:e.dataUrl,initialImage:e.currentImageDataUrl,warning:e.warning,status:e.status,isUpdated:e.isUpdated,isUploadedPhotoTooSmall:e.isUploadedPhotoTooSmall,progress:o,fileName:e.fileName}}),(function(t){return{onUploadedPhotoTooSmall:function(e){return t(c({isUploadedPhotoTooSmall:e}))},onDismissInfoBar:function(){return t(P())},onError:function(e){return t(b({warning:e}))},onUploadNewPhoto:function(){return t(m())},onFileSelected:function(e,o){return function(t,e,o){var n=new FileReader,a=function(){return t(b({warning:"NOT_AN_IMAGE"}))};n.onerror=a,n.onloadend=function(){var r=document.createElement("img");r.onerror=a,r.onload=function(){t(S({dataUrl:r.src,fileName:e.name})),t(L()),o&&t(N({selectedIndex:0,newImageUrl:r.src}))},r.src=String(n.result)},n.readAsDataURL(e)}(t,e,o)},onCancel:function(){return t(u())},onClose:function(){return t(p())},onDone:function(){return t(d())},onImageEditPaneDismissed:function(){return t(g())},onImageUpdated:function(){return t(h())},onUploadProgress:function(e){return t(E({now:e}))}}}))(ge),fe=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?K()(o):(n.prototype=o.prototype,new n)}}(),ve=function(){return(ve=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Se=function(t){function e(e){var o=t.call(this,e)||this;return o.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},o.loadCurrentImage=o.loadCurrentImage.bind(o),o.imageLoaded=o.imageLoaded.bind(o),o.imageLoadFailed=o.imageLoadFailed.bind(o),o.startUpload=o.startUpload.bind(o),o}return fe(e,t),e.prototype.render=function(){return Q.createElement(he,ve({loadCurrentImage:this.loadCurrentImage,startUpload:this.startUpload,loadedEmptyImage:this.props.onLoadedEmptyImage},this.props))},e.prototype.loadCurrentImage=function(){var t=this,e=new Image;e.crossOrigin="Anonymous",e.onload=function(){return t.imageLoaded(e)},e.onerror=function(){return t.imageLoadFailed()},e.src=ot()(this.props.personImageUrl)?this.props.personImageUrl[this.props.photoListSelectedIndex||0]||"":this.props.personImageUrl},e.prototype.imageLoaded=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight;var o=e.getContext("2d");o?(o.drawImage(t,0,0),this.props.onLoadedCurrentImage(at(e,this.props.isComponentInline),!!this.props.isSuggestedPhoto,ot()(this.props.personImageUrl))):this.props.onError("UNSUPPORTED_BROWSER")},e.prototype.imageLoadFailed=function(){this.props.onLoadedEmptyImage(ot()(this.props.personImageUrl))},e.prototype.startUpload=function(){var t=this.getImageDataUrlFromCanvas();this.props.onStartUpload(tt()(),t,this.props.selectedIndex,this.props.imageUrls,this.props.onUpload,this.props.getPhotoListDataOnUpload)},e.prototype.getImageDataUrlFromCanvas=function(t){var e=this;if(!this.props.image)return"";t||(t=648);var o=document.createElement("canvas"),n=this.props.naturalMin/this.props.absoluteScale;o.width=n,o.height=n;var a=o.getContext("2d");if(!a)return this.props.onError("UNSUPPORTED_BROWSER"),"";a.fillStyle=this.props.customBackgroundColor||"white",a.fillRect(0,0,o.width,o.height),this.props.image&&it(a,o.width,this.props.imageRotationAngle,this.props.orientation,this.props.image,(function(t,n){return a.drawImage(n,e.props.xpos*o.width/256,e.props.ypos*o.height/256,e.props.naturalWidth,e.props.naturalHeight)}));for(var r=1;o.width*r/4>=t;)r/=2,a.drawImage(o,0,0,o.width*r,o.height*r);var i=document.createElement("canvas"),s=Math.min(this.props.naturalMin/this.props.absoluteScale,t);i.width=s,i.height=s;var l=i.getContext("2d");return l?(l.drawImage(o,0,0,o.width*r,o.width*r,0,0,s,s),at(i,this.props.isComponentInline)):(this.props.onError("UNSUPPORTED_BROWSER"),"")},e}(Q.Component);var be=Object(nt.c)((function(t){return ve(ve({},M.getSelectors(t).getEditCanvasState()),M.getSelectors(t).getPhotoListState())}),(function(t){return{onError:function(e){return t(b({warning:e}))},onLoadedCurrentImage:function(e,o,n){return t(f({dataUrl:e,isSuggestedPhoto:o,isPhotoListPresent:n}))},onLoadedEmptyImage:function(e){return t(v({isPhotoListPresent:e}))},onStartUpload:function(e,o,n,a,r,i){return function(t,e,o,n,a,r,i){t(y({now:e})),r(o,(function(){t(I({dataUrl:o})),null==i||i(n===a.length?-1:n,a)}),(function(){return t(b({warning:"UNKNOWN"}))}))}(t,e,o,n,a,r,i)}}}))(Se),ye=o(1224);function Ee(){Object(ye.a)(void 0,{disableWarnings:!0})}var Ie=function(){var t=function(e,o){return(t=Z.a||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?K()(o):(n.prototype=o.prototype,new n)}}(),Pe=function(){return(Pe=G.a||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var a in e=arguments[o])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},Ce=null,Ue=!1,Re=0,xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.prototype.UNSAFE_componentWillMount=function(){if(Re>=1)throw new Error("Can only mount one StandalonePhotoPicker at a time.");if(Re+=1,Ue||(Ue=!0,Ee()),null===Ce){var t=Object(i.createStore)(Object(V.a)([M]));Ce=new q.a({reduxStore:t})}},e.prototype.componentWillUnmount=function(){Re-=1},e.prototype.render=function(){return Ce?Q.createElement(J.a,{context:Ce},Q.createElement(be,Pe({},this.props))):null},e}(Q.Component)}}]);